import pandas as pd
import numpy as np
import os
from sklearn.model_selection import train_test_split

# ------------------------
# ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡
# ------------------------
TV_Test_Ration = 90  # Ø¯Ø±ØµØ¯ Ø¯Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Train/Validation
input_path = r"C:\Users\Pourali\Desktop\corn\Data\Data-Corn_X_Moisture (%).xlsx"

# Ù…Ø³ÛŒØ± Ù¾ÙˆØ´Ù‡ Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§
output_base = r"C:\Users\Pourali\Desktop\corn\Data\Split_Files"

# Ø§ÛŒØ¬Ø§Ø¯ Ù¾ÙˆØ´Ù‡ Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯
os.makedirs(os.path.join(output_base, "TV"), exist_ok=True)
os.makedirs(os.path.join(output_base, "Test"), exist_ok=True)

# Ø®ÙˆØ§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡ Ø§Ø² ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„
data = pd.read_excel(input_path)

# ------------------------
# ØªÙ‚Ø³ÛŒÙ… ØªØµØ§Ø¯ÙÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± 30 ØªÚ©Ø±Ø§Ø±
# ------------------------
for i in range(1, 31):
    # Ù†Ø³Ø¨Øª ØªØ³Øª
    test_size = (100 - TV_Test_Ration) / 100.0

    # ØªÙ‚Ø³ÛŒÙ… ØªØµØ§Ø¯ÙÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ø¨Ø¯ÙˆÙ† seed Ø¨Ø±Ø§ÛŒ ØªØµØ§Ø¯Ù Ú©Ø§Ù…Ù„)
    train_val, test = train_test_split(data, test_size=test_size, shuffle=True, random_state=None)

    # Ù…Ø³ÛŒØ±Ù‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡
    tv_path = os.path.join(output_base, "TV", f"TV_Set_{i}.xlsx")
    test_path = os.path.join(output_base, "Test", f"Test_Set_{i}.xlsx")

    # Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§
    train_val.to_excel(tv_path, index=False)
    test.to_excel(test_path, index=False)

    print(f"âœ… Split {i} done: {len(train_val)} TV / {len(test)} Test")

print("\nğŸ‰ ØªÙ…Ø§Ù… 30 ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ Ùˆ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.")
